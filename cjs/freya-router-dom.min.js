"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var resolvePathname=_interopDefault(require("resolve-pathname")),valueEqual=_interopDefault(require("value-equal"));require("tiny-warning");var invariant=_interopDefault(require("tiny-invariant")),createContext=_interopDefault(require("mini-create-react-context")),React=_interopDefault(require("react"));require("prop-types");var pathToRegexp=_interopDefault(require("path-to-regexp"));require("react-is");var hoistStatics=_interopDefault(require("hoist-non-react-statics")),reactKeepAlive=require("react-keep-alive");function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||(o[n]=e[n]);return o}function addLeadingSlash(e){return"/"===e.charAt(0)?e:"/"+e}function stripLeadingSlash(e){return"/"===e.charAt(0)?e.substr(1):e}function hasBasename(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}function stripBasename(e,t){return hasBasename(e,t)?e.substr(t.length):e}function stripTrailingSlash(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function parsePath(e){var t=e||"/",n="",a="",o=t.indexOf("#");-1!==o&&(a=t.substr(o),t=t.substr(0,o));var r=t.indexOf("?");return-1!==r&&(n=t.substr(r),t=t.substr(0,r)),{pathname:t,search:"?"===n?"":n,hash:"#"===a?"":a}}function createPath(e){var t=e.pathname,n=e.search,a=e.hash,o=t||"/";return n&&"?"!==n&&(o+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(o+="#"===a.charAt(0)?a:"#"+a),o}function createLocation(e,t,n,a){var o;return"string"==typeof e?(o=parsePath(e)).state=t:(void 0===(o=_extends({},e)).pathname&&(o.pathname=""),o.search?"?"!==o.search.charAt(0)&&(o.search="?"+o.search):o.search="",o.hash?"#"!==o.hash.charAt(0)&&(o.hash="#"+o.hash):o.hash="",void 0!==t&&void 0===o.state&&(o.state=t)),n&&(o.key=n),a?o.pathname?"/"!==o.pathname.charAt(0)&&(o.pathname=resolvePathname(o.pathname,a.pathname)):o.pathname=a.pathname:o.pathname||(o.pathname="/"),o}function locationsAreEqual(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&valueEqual(e.state,t.state)}function createTransitionManager(){var r=null;var a=[];return{setPrompt:function(e){return r=e,function(){r===e&&(r=null)}},confirmTransitionTo:function(e,t,n,a){if(null!=r){var o="function"==typeof r?r(e,t):r;"string"==typeof o?"function"==typeof n?n(o,a):a(!0):a(!1!==o)}else a(!0)},appendListener:function(e){var t=!0;function n(){t&&e.apply(void 0,arguments)}return a.push(n),function(){t=!1,a=a.filter(function(e){return e!==n})}},notifyListeners:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.forEach(function(e){return e.apply(void 0,t)})}}}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);function getConfirmation(e,t){t(window.confirm(e))}function supportsHistory(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}function supportsPopStateOnHashChange(){return-1===window.navigator.userAgent.indexOf("Trident")}function supportsGoWithoutReloadUsingHash(){return-1===window.navigator.userAgent.indexOf("Firefox")}function isExtraneousPopstateEvent(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")}var PopStateEvent="popstate",HashChangeEvent="hashchange";function getHistoryState(){try{return window.history.state||{}}catch(e){return{}}}function createBrowserHistory(e){void 0===e&&(e={}),canUseDOM||invariant(!1);var c=window.history,s=supportsHistory(),t=!supportsPopStateOnHashChange(),n=null,a=e,o=a.forceRefresh,u=void 0!==o&&o,r=a.getUserConfirmation,l=void 0===r?getConfirmation:r,i=a.keyLength,h=void 0===i?6:i,p=e.basename?stripTrailingSlash(addLeadingSlash(e.basename)):"";function d(e){var t=e||{},n=t.key,a=t.state,o=window.location,r=o.pathname+o.search+o.hash;return p&&(r=stripBasename(r,p)),createLocation(r,a,n)}function f(){return Math.random().toString(36).substr(2,h)}var m=createTransitionManager();function v(e){e&&"PUSH"==e.action?window.globalManger.push(e.location):"REPLACE"==e.action?(window.globalManger.pop(),window.globalManger.push(e.location)):"POP"==e.action&&(n?(window.globalManger=window.globalManger.slice(0,n),n=null):1!==window.globalManger.length&&window.globalManger.pop()),Object.assign(C,e),C.length=c.length,m.notifyListeners(C.location,C.action)}function g(e){isExtraneousPopstateEvent(e)||R(d(e.state))}function E(){R(d(getHistoryState()))}var y=!1;function R(t){if(y)y=!1,v();else{m.confirmTransitionTo(t,"POP",l,function(e){e?v({action:"POP",location:t}):function(e){var t=C.location,n=w.indexOf(t.key);-1===n&&(n=0);var a=w.indexOf(e.key);-1===a&&(a=0);var o=n-a;o&&(y=!0,S(o))}(t)})}}var P=d(getHistoryState());window.globalManger=[P];var w=[P.key];function x(e){return p+createPath(e)}function S(e){n=e,c.go(e)}var _=0;function L(e){1===(_+=e)&&1===e?(window.addEventListener(PopStateEvent,g),t&&window.addEventListener(HashChangeEvent,E)):0===_&&(window.removeEventListener(PopStateEvent,g),t&&window.removeEventListener(HashChangeEvent,E))}var T=!1;var C={length:c.length,action:"POP",location:P,createHref:x,push:function(e,t){var i=createLocation(e,t,f(),C.location);m.confirmTransitionTo(i,"PUSH",l,function(e){if(e){var t=x(i),n=i.key,a=i.state;if(s)if(c.pushState({key:n,state:a},null,t),u)window.location.href=t;else{var o=w.indexOf(C.location.key),r=w.slice(0,-1===o?0:o+1);r.push(i.key),w=r,v({action:"PUSH",location:i})}else window.location.href=t}})},replace:function(e,t){var r="REPLACE",i=createLocation(e,t,f(),C.location);m.confirmTransitionTo(i,r,l,function(e){if(e){var t=x(i),n=i.key,a=i.state;if(s)if(c.replaceState({key:n,state:a},null,t),u)window.location.replace(t);else{var o=w.indexOf(C.location.key);-1!==o&&(w[o]=i.key),v({action:r,location:i})}else window.location.replace(t)}})},go:S,goBack:function(){S(-1)},goForward:function(){S(1)},block:function(e){void 0===e&&(e=!1);var t=m.setPrompt(e);return T||(L(1),T=!0),function(){return T&&(T=!1,L(-1)),t()}},listen:function(e){var t=m.appendListener(e);return L(1),function(){L(-1),t()}}};return C}console.log("======== freya-history =========");var HashChangeEvent$1="hashchange",HashPathCoders={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+stripLeadingSlash(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};function getHashPath(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function pushHashPath(e){window.location.hash=e}function replaceHashPath(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=t?t:0)+"#"+e)}function createHashHistory(e){void 0===e&&(e={}),canUseDOM||invariant(!1);var t=window.history,n=(supportsGoWithoutReloadUsingHash(),e),a=n.getUserConfirmation,i=void 0===a?getConfirmation:a,o=n.hashType,r=void 0===o?"slash":o,c=e.basename?stripTrailingSlash(addLeadingSlash(e.basename)):"",s=HashPathCoders[r],u=s.encodePath,l=s.decodePath;function h(){var e=l(getHashPath());return c&&(e=stripBasename(e,c)),createLocation(e)}var p=createTransitionManager();function d(e){Object.assign(_,e),_.length=t.length,p.notifyListeners(_.location,_.action)}var f=!1,m=null;function v(){var e=getHashPath(),t=u(e);if(e!==t)replaceHashPath(t);else{var n=h(),a=_.location;if(!f&&locationsAreEqual(a,n))return;if(m===createPath(n))return;m=null,function(t){if(f)f=!1,d();else{p.confirmTransitionTo(t,"POP",i,function(e){e?d({action:"POP",location:t}):function(e){var t=_.location,n=R.lastIndexOf(createPath(t));-1===n&&(n=0);var a=R.lastIndexOf(createPath(e));-1===a&&(a=0);var o=n-a;o&&(f=!0,P(o))}(t)})}}(n)}}var g=getHashPath(),E=u(g);g!==E&&replaceHashPath(E);var y=h(),R=[createPath(y)];function P(e){t.go(e)}var w=0;function x(e){1===(w+=e)&&1===e?window.addEventListener(HashChangeEvent$1,v):0===w&&window.removeEventListener(HashChangeEvent$1,v)}var S=!1;var _={length:t.length,action:"POP",location:y,createHref:function(e){return"#"+u(c+createPath(e))},push:function(e,t){var r=createLocation(e,void 0,void 0,_.location);p.confirmTransitionTo(r,"PUSH",i,function(e){if(e){var t=createPath(r),n=u(c+t);if(getHashPath()!==n){m=t,pushHashPath(n);var a=R.lastIndexOf(createPath(_.location)),o=R.slice(0,-1===a?0:a+1);o.push(t),R=o,d({action:"PUSH",location:r})}else d()}})},replace:function(e,t){var o="REPLACE",r=createLocation(e,void 0,void 0,_.location);p.confirmTransitionTo(r,o,i,function(e){if(e){var t=createPath(r),n=u(c+t);getHashPath()!==n&&(m=t,replaceHashPath(n));var a=R.indexOf(createPath(_.location));-1!==a&&(R[a]=t),d({action:o,location:r})}})},go:P,goBack:function(){P(-1)},goForward:function(){P(1)},block:function(e){void 0===e&&(e=!1);var t=p.setPrompt(e);return S||(x(1),S=!0),function(){return S&&(S=!1,x(-1)),t()}},listen:function(e){var t=p.appendListener(e);return x(1),function(){x(-1),t()}}};return _}function clamp(e,t,n){return Math.min(Math.max(e,t),n)}function createMemoryHistory(e){void 0===e&&(e={});var t=e,o=t.getUserConfirmation,n=t.initialEntries,a=void 0===n?["/"]:n,r=t.initialIndex,i=void 0===r?0:r,c=t.keyLength,s=void 0===c?6:c,u=createTransitionManager();function l(e){Object.assign(v,e),v.length=v.entries.length,u.notifyListeners(v.location,v.action)}function h(){return Math.random().toString(36).substr(2,s)}var p=clamp(i,0,a.length-1),d=a.map(function(e){return createLocation(e,void 0,"string"==typeof e?h():e.key||h())}),f=createPath;function m(e){var t=clamp(v.index+e,0,v.entries.length-1),n=v.entries[t];u.confirmTransitionTo(n,"POP",o,function(e){e?l({action:"POP",location:n,index:t}):l()})}var v={length:d.length,action:"POP",location:d[p],index:p,entries:d,createHref:f,push:function(e,t){var a=createLocation(e,t,h(),v.location);u.confirmTransitionTo(a,"PUSH",o,function(e){if(e){var t=v.index+1,n=v.entries.slice(0);n.length>t?n.splice(t,n.length-t,a):n.push(a),l({action:"PUSH",location:a,index:t,entries:n})}})},replace:function(e,t){var n="REPLACE",a=createLocation(e,t,h(),v.location);u.confirmTransitionTo(a,n,o,function(e){e&&(v.entries[v.index]=a,l({action:n,location:a}))})},go:m,goBack:function(){m(-1)},goForward:function(){m(1)},canGo:function(e){var t=v.index+e;return 0<=t&&t<v.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return v}var createNamedContext=function(e){var t=createContext();return t.displayName=e,t},context=createNamedContext("Router"),Router=function(n){function e(e){var t;return(t=n.call(this,e)||this).state={location:e.history.location},t._isMounted=!1,t._pendingLocation=null,e.staticContext||(t.unlisten=e.history.listen(function(e){t._isMounted?t.setState({location:e}):t._pendingLocation=e})),t}_inheritsLoose(e,n),e.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var t=e.prototype;return t.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},t.componentWillUnmount=function(){this.unlisten&&this.unlisten()},t.render=function(){return React.createElement(context.Provider,{children:this.props.children||null,value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}})},e}(React.Component),MemoryRouter=function(o){function e(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))||this).history=createMemoryHistory(e.props),e}return _inheritsLoose(e,o),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),Lifecycle=function(e){function t(){return e.apply(this,arguments)||this}_inheritsLoose(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(React.Component);function Prompt(e){var a=e.message,t=e.when,o=void 0===t||t;return React.createElement(context.Consumer,null,function(e){if(e||invariant(!1),!o||e.staticContext)return null;var n=e.history.block;return React.createElement(Lifecycle,{onMount:function(e){e.release=n(a)},onUpdate:function(e,t){t.message!==a&&(e.release(),e.release=n(a))},onUnmount:function(e){e.release()},message:a})})}var cache={},cacheLimit=1e4,cacheCount=0;function compilePath(e){if(cache[e])return cache[e];var t=pathToRegexp.compile(e);return cacheCount<cacheLimit&&(cache[e]=t,cacheCount++),t}function generatePath(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:compilePath(e)(t,{pretty:!0})}function Redirect(e){var r=e.computedMatch,i=e.to,t=e.push,c=void 0!==t&&t;return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=e.history,n=e.staticContext,a=c?t.push:t.replace,o=createLocation(r?"string"==typeof i?generatePath(i,r.params):_extends({},i,{pathname:generatePath(i.pathname,r.params)}):i);return n?(a(o),null):React.createElement(Lifecycle,{onMount:function(){a(o)},onUpdate:function(e,t){var n=createLocation(t.to);locationsAreEqual(n,_extends({},o,{key:n.key}))||a(o)},to:i})})}var cache$1={},cacheLimit$1=1e4,cacheCount$1=0;function compilePath$1(e,t){var n=""+t.end+t.strict+t.sensitive,a=cache$1[n]||(cache$1[n]={});if(a[e])return a[e];var o=[],r={regexp:pathToRegexp(e,o,t),keys:o};return cacheCount$1<cacheLimit$1&&(a[e]=r,cacheCount$1++),r}function matchPath(u,e){void 0===e&&(e={}),"string"!=typeof e&&!Array.isArray(e)||(e={path:e});var t=e,n=t.path,a=t.exact,l=void 0!==a&&a,o=t.strict,h=void 0!==o&&o,r=t.sensitive,p=void 0!==r&&r;return[].concat(n).reduce(function(e,t){if(!t)return null;if(e)return e;var n=compilePath$1(t,{end:l,strict:h,sensitive:p}),a=n.regexp,o=n.keys,r=a.exec(u);if(!r)return null;var i=r[0],c=r.slice(1),s=u===i;return l&&!s?null:{path:t,url:"/"===t&&""===i?"/":i,isExact:s,params:o.reduce(function(e,t,n){return e[t.name]=c[n],e},{})}},null)}function isEmptyChildren(e){return 0===React.Children.count(e)}var Route=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var c=this;return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=c.props.location||e.location,n=_extends({},e,{location:t,match:c.props.computedMatch?c.props.computedMatch:c.props.path?matchPath(t.pathname,c.props):e.match}),a=c.props,o=a.children,r=a.component,i=a.render;return Array.isArray(o)&&0===o.length&&(o=null),"function"==typeof o&&void 0===(o=o(n))&&(o=null),React.createElement(context.Provider,{value:n},o&&!isEmptyChildren(o)?o:n.match?r?React.createElement(r,n):i?i(n):null:null)})},t}(React.Component);function addLeadingSlash$1(e){return"/"===e.charAt(0)?e:"/"+e}function addBasename(e,t){return e?_extends({},t,{pathname:addLeadingSlash$1(e)+t.pathname}):t}function stripBasename$1(e,t){if(!e)return t;var n=addLeadingSlash$1(e);return 0!==t.pathname.indexOf(n)?t:_extends({},t,{pathname:t.pathname.substr(n.length)})}function createURL(e){return"string"==typeof e?e:createPath(e)}function staticHandler(e){return function(){invariant(!1)}}function noop(){}var StaticRouter=function(o){function e(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=o.call.apply(o,[this].concat(n))||this).handlePush=function(e){return t.navigateTo(e,"PUSH")},t.handleReplace=function(e){return t.navigateTo(e,"REPLACE")},t.handleListen=function(){return noop},t.handleBlock=function(){return noop},t}_inheritsLoose(e,o);var t=e.prototype;return t.navigateTo=function(e,t){var n=this.props,a=n.basename,o=void 0===a?"":a,r=n.context,i=void 0===r?{}:r;i.action=t,i.location=addBasename(o,createLocation(e)),i.url=createURL(i.location)},t.render=function(){var e=this.props,t=e.basename,n=void 0===t?"":t,a=e.context,o=void 0===a?{}:a,r=e.location,i=void 0===r?"/":r,c=_objectWithoutPropertiesLoose(e,["basename","context","location"]),s={createHref:function(e){return addLeadingSlash$1(n+createURL(e))},action:"POP",location:stripBasename$1(n,createLocation(i)),push:this.handlePush,replace:this.handleReplace,go:staticHandler("go"),goBack:staticHandler("goBack"),goForward:staticHandler("goForward"),listen:this.handleListen,block:this.handleBlock};return React.createElement(Router,_extends({},c,{history:s,staticContext:o}))},e}(React.Component),push_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},push_pre={zIndex:-1,position:"absolute",left:0,top:0},gesture_pre={zIndex:-1,position:"absolute",left:0,top:0},pop_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},pop_pre={position:"absolute",left:0,top:0,boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)",background:"#fff"};function firstDivInBody(){for(var e=document.body.children,t=0;t<e.length;t++)if("DIV"==e[t].tagName)return e[t]}var Switch=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var t=this;return React.createElement(context.Consumer,null,function(e){return React.createElement(AnimateRoute,_extends({},t.props,{adapt:e}))})},t}(React.Component),isWebView="undefined"!=typeof navigator&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),AnimateRoute=function(a){function e(){for(var l,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(l=a.call.apply(a,[this].concat(t))||this).isRerender=!1,l.prePage=null,l.matchPage=null,l.action="",l.canAnimate=!0,l.single=!0,l.SCREEN_WIDTH=window.innerWidth,l.MATCH_SCREEN_OFFSET=l.SCREEN_WIDTH,l.BOTTOM_SCREEN_OFFSET=.3*-l.SCREEN_WIDTH,l.BACK_ACTIVE_POSITION=.1*l.SCREEN_WIDTH,l.rootElement=firstDivInBody(),l.SIZE={width:window.screen.width,minHeight:window.innerHeight},l.easeInQuad=function(e,t,n,a){var o=e/a;return t+n*(o*o)},l.easeOutQuad=function(e,t,n,a){var o=e/a;return t+n*(-o*o+2*o)},l.easeInOut=function(e,t,n,a){if(e<a/2)return l.easeInQuad(e,t,n/2,a/2);var o=e-a/2,r=t+n/2;return l.easeOutQuad(o,r,n/2,a/2)},l.animate=function(e){var o=e.begin,r=e.end,i=e.ref,c=e.done,t=e.type,n=void 0===t?"ease-in-out":t,a=e.duration,s=void 0===a?.1:a,u="ease-in-out"==n?l.easeInOut:"ease-in"==n?l.easeInQuad:"ease-out"==n?l.easeOutQuad:l.easeInOut;!function t(n){var a=u(n,o,r-o,s);requestAnimationFrame(function(e){i.style.transform="translate3d("+a+"px,0px,0)",a!=r?t(n+.01):c&&c()})}(0)},l.animatePop=function(){l.animate({begin:l.BOTTOM_SCREEN_OFFSET,end:0,ref:l.matchRef,done:function(e){l.isRerender=!0,l.forceUpdate()}}),l.animate({begin:0,end:l.MATCH_SCREEN_OFFSET,ref:l.preRef})},l.animatePush=function(){l.animate({begin:l.MATCH_SCREEN_OFFSET,end:0,ref:l.matchRef,done:function(e){return l.matchRef.style.transform=null}}),l.animate({begin:0,end:l.BOTTOM_SCREEN_OFFSET,ref:l.preRef,done:l.hideBottom})},l.findMatchElement=function(n){var a,o;return n=n||l.props.location||l.props.adapt.location,React.Children.forEach(l.props.children,function(e){if(null==o&&React.isValidElement(e)){var t=(a=e).props.path||e.props.from;o=t?matchPath(n.pathname,_extends({},e.props,{path:t})):l.props.adapt.match}}),o?React.cloneElement(a,{location:n,computedMatch:o}):null},l.findMatchElementByLocation=function(e){return l.findMatchElement(e)},l.setTransform=function(e){l.matchRef.style.transform="translate3d("+e+"px,0px,0)",l.setBottomTransform(e)},l.setBottomTransform=function(e){var t=l.BOTTOM_SCREEN_OFFSET+.3*e;l.preRef.style.transform="translate3d("+t+"px,0px,0)"},l.hideBottom=function(){l.preRef.style.opacity=0},l.showBottom=function(){l.preRef.style.opacity=null},l.onTouchStart=function(e){l.rootElement.style.overflow="hidden",l._ScreenX=l._startScreenX=e.touches[0].screenX,l.gestureBackActive=l._startScreenX<l.BACK_ACTIVE_POSITION,l.gestureBackActive&&(l.showBottom(),l._lastScreenX=l._lastScreenX||0,l.startTime=+new Date)},l.onTouchMove=function(e){if(l.gestureBackActive){var t=e.touches[0].screenX;if(!(l._startScreenX>t)){e.preventDefault();var n=Math.round(t-l._ScreenX);l._ScreenX=t,l._lastScreenX+=n,l.setTransform(l._lastScreenX),isWebView&&e.changedTouches[0].clientY<0&&l.onTouchEnd()}}},l.reset=function(){l.animate({begin:l._lastScreenX,end:0,ref:l.matchRef,done:function(e){return l.preRef.style.opacity=0}}),l.animate({begin:l.BOTTOM_SCREEN_OFFSET+.3*l._lastScreenX,end:l.BOTTOM_SCREEN_OFFSET,ref:l.preRef})},l.onTouchEnd=function(e){l.rootElement.style.overflow=null,l.gestureBackActive&&(+new Date-l.startTime<300&&l._lastScreenX>.2*l.SCREEN_WIDTH?(l.animate({begin:l.BOTTOM_SCREEN_OFFSET+.3*l._lastScreenX,end:0,ref:l.preRef,duration:.05}),l.animate({begin:l._lastScreenX,end:l.SCREEN_WIDTH,ref:l.matchRef,done:l.props.adapt.history.goBack,type:"ease-out",duration:.05}),l._lastScreenX=0,l.isRerender=!0,l.gestureBackActive=!1):(l._lastScreenX<l.SCREEN_WIDTH/2?0<l._lastScreenX&&l.reset():(l.animate({begin:l.BOTTOM_SCREEN_OFFSET+.3*l._lastScreenX,end:0,ref:l.preRef,duration:.05}),l.animate({begin:l._lastScreenX,end:l.SCREEN_WIDTH,ref:l.matchRef,done:l.props.adapt.history.goBack,type:"ease-out",duration:.05}),l.isRerender=!0),l.gestureBackActive=!1,l._lastScreenX=0))},l.reRender=function(){if(l.single)return React.createElement("div",{ref:function(e){return l.preRef=l.matchRef=e}},l.matchPage);var e=window.globalManger[window.globalManger.length-2];return l.prePage=l.findMatchElementByLocation(e),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d("+l.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},l.SIZE,gesture_pre,{opacity:0,position:"fixed",left:0,top:-window.globalPosition[e.pathname]||0}),key:Math.random(),ref:function(e){return l.preRef=e}},l.prePage),React.createElement("div",{style:_extends({},l.SIZE,pop_match),key:Math.random(),ref:function(e){e&&(e.removeEventListener("touchstart",l.onTouchStart),e.removeEventListener("touchmove",l.onTouchMove),e.removeEventListener("touchend",l.onTouchEnd),e.addEventListener("touchstart",l.onTouchStart),e.addEventListener("touchmove",l.onTouchMove),e.addEventListener("touchend",l.onTouchEnd),e.addEventListener("touchstart",l.onTouchStart),e.addEventListener("touchmove",l.onTouchMove),e.addEventListener("touchend",l.onTouchEnd)),l.matchRef=e}},l.matchPage))},l.renderPop=function(){if(!l.prePage)return l.canAnimate=!1,React.createElement("div",{ref:function(e){return l.matchRef=e}},l.matchPage);if(l.prePage.props.path==l.matchPage.props.path){if(!(1<window.globalManger.length))return l.canAnimate=!1,React.createElement("div",{ref:function(e){return l.matchRef=e}},l.matchPage);l.props.adapt.history.goBack()}return React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d("+l.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},l.SIZE,pop_match),key:Math.random().toString(),ref:function(e){e&&(e.removeEventListener("touchstart",l.onTouchStart),e.removeEventListener("touchmove",l.onTouchMove),e.removeEventListener("touchend",l.onTouchEnd),e.addEventListener("touchstart",l.onTouchStart),e.addEventListener("touchmove",l.onTouchMove),e.addEventListener("touchend",l.onTouchEnd)),l.matchRef=e}},l.matchPage),React.createElement("div",{id:"prepage",style:_extends({transform:"translate3d(0px,0px,0)"},l.SIZE,pop_pre,{position:"fixed",left:0,top:-(document.documentElement.scrollTop||document.body.scrollTop)}),key:Math.random().toString(),ref:function(e){l.preRef=e}},l.prePage))},l.correctPosition=function(e){return window.globalPosition=window.globalPosition||{},window.globalPosition[e]=document.documentElement.scrollTop||document.body.scrollTop,window.globalPosition[e]},l.renderPush=function(){if(l.single&&"REPLACE"==l.action)return l.canAnimate=!1,React.createElement("div",{ref:function(e){return l.preRef=l.matchRef=e}},l.matchPage);var e=window.globalManger[window.globalManger.length-2];return l.correctPosition(e.pathname),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d(0px,0px,0)"},l.SIZE,push_pre,{position:"fixed",left:0,top:-window.globalPosition[e.pathname]||0}),key:Math.random(),ref:function(e){return e&&(e.style.opacity=null),l.preRef=e}},l.prePage),React.createElement("div",{style:_extends({transform:"translate3d("+l.MATCH_SCREEN_OFFSET+"px,0px,0)"},l.SIZE,push_match),key:Math.random(),ref:function(e){e&&(e.removeEventListener("touchstart",l.onTouchStart),e.removeEventListener("touchmove",l.onTouchMove),e.removeEventListener("touchend",l.onTouchEnd),e.addEventListener("touchstart",l.onTouchStart),e.addEventListener("touchmove",l.onTouchMove),e.addEventListener("touchend",l.onTouchEnd),e.addEventListener("touchstart",l.onTouchStart),e.addEventListener("touchmove",l.onTouchMove),e.addEventListener("touchend",l.onTouchEnd)),l.matchRef=e}},l.matchPage))},l.preRender=function(){l.action=l.props.adapt.history.action,l.single=1==window.globalManger.length,document.addEventListener("WinJSBridgeReady",function(e){window.WinJSBridge.call("webview","dragbackenable",{enable:l.single})}),l.prePage=l.matchPage,l.matchPage=l.findMatchElement()},l}_inheritsLoose(e,a);var t=e.prototype;return t.componentDidUpdate=function(e,t,n){this.canAnimate&&!this.isRerender&&("POP"==this.action?this.animatePop():this.animatePush()),this.isRerender=!1,this.canAnimate=!0},t.render=function(){return this.preRender(),this.SIZE={width:window.screen.width,minHeight:window.innerHeight},this.matchPage?"POP"==this.action?this.isRerender?this.reRender():this.renderPop():this.renderPush():"404"},e}(React.Component);function withRouter(a){function e(e){var t=e.wrappedComponentRef,n=_objectWithoutPropertiesLoose(e,["wrappedComponentRef"]);return React.createElement(context.Consumer,null,function(e){return e||invariant(!1),React.createElement(a,_extends({},n,e,{ref:t}))})}var t="withRouter("+(a.displayName||a.name)+")";return e.displayName=t,e.WrappedComponent=a,hoistStatics(e,a)}var NormalSwitch=function(e){function t(){return e.apply(this,arguments)||this}_inheritsLoose(t,e);var n=t.prototype;return n.componentDidMount=function(){document.addEventListener("WinJSBridgeReady",function(e){window.WinJSBridge.call("webview","dragbackenable",{enable:!1})})},n.render=function(){var e=this;return React.createElement(context.Consumer,null,function(n){n||invariant(!1);var a,o,r=e.props.location||n.location;return React.Children.forEach(e.props.children,function(e){if(null==o&&React.isValidElement(e)){var t=(a=e).props.path||e.props.from;o=t?matchPath(r.pathname,_extends({},e.props,{path:t})):n.match}}),o?React.cloneElement(a,{location:r,computedMatch:o}):null})},t}(React.Component),lte10=navigator.userAgent.match(/Mac OS/)&&!navigator.userAgent.match(/os\s+(\d+)/i)&&navigator.userAgent.match(/os\s+(\d+)/i)[1]-0<10;function renderRoutes(e){return lte10?React.createElement(reactKeepAlive.Provider,null,React.createElement(NormalSwitch,null,e.map(function(t,n){return React.createElement(Route,_extends({key:n},t,{component:function(e){return React.createElement(reactKeepAlive.KeepAlive,{name:n.toString()},React.createElement("div",null,React.createElement(t.component,e)))}}))}))):React.createElement(reactKeepAlive.Provider,null,React.createElement(Switch,null,e.map(function(t,n){return React.createElement(Route,_extends({key:n},t,{component:function(e){return React.createElement(reactKeepAlive.KeepAlive,{name:n.toString()},React.createElement("div",null,React.createElement(t.component,e)))}}))})))}var BrowserRouter=function(o){function e(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))||this).history=createBrowserHistory(e.props),e}return _inheritsLoose(e,o),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),HashRouter=function(o){function e(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))||this).history=createHashHistory(e.props),e}return _inheritsLoose(e,o),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),resolveToLocation=function(e,t){return"function"==typeof e?e(t):e},normalizeToLocation=function(e,t){return"string"==typeof e?createLocation(e,null,null,t):e};function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function LinkAnchor(e){var t=e.innerRef,n=e.navigate,a=e.onClick,o=_objectWithoutPropertiesLoose(e,["innerRef","navigate","onClick"]),r=o.target;return React.createElement("a",_extends({},o,{ref:t,onClick:function(t){try{a&&a(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0!==t.button||r&&"_self"!==r||isModifiedEvent(t)||(t.preventDefault(),n())}}))}function Link(e){var t=e.component,o=void 0===t?LinkAnchor:t,r=e.replace,i=e.to,c=_objectWithoutPropertiesLoose(e,["component","replace","to"]);return React.createElement(context.Consumer,null,function(t){t||invariant(!1);var n=t.history,e=normalizeToLocation(resolveToLocation(i,t.location),t.location),a=e?n.createHref(e):"";return React.createElement(o,_extends({},c,{href:a,navigate:function(){var e=resolveToLocation(i,t.location);(r?n.replace:n.push)(e)}}))})}function joinClassnames(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(function(e){return e}).join(" ")}function NavLink(e){var t=e["aria-current"],l=void 0===t?"page":t,n=e.activeClassName,h=void 0===n?"active":n,p=e.activeStyle,d=e.className,f=e.exact,m=e.isActive,v=e.location,g=e.strict,E=e.style,y=e.to,R=_objectWithoutPropertiesLoose(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","strict","style","to"]);return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=v||e.location,n=t.pathname,a=normalizeToLocation(resolveToLocation(y,t),t),o=a.pathname,r=o&&o.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),i=r?matchPath(n,{path:r,exact:f,strict:g}):null,c=!!(m?m(i,e.location):i),s=c?joinClassnames(d,h):d,u=c?_extends({},E,p):E;return React.createElement(Link,_extends({"aria-current":c&&l||null,className:s,style:u,to:a},R))})}Object.keys(reactKeepAlive).forEach(function(e){exports[e]=reactKeepAlive[e]}),exports.BrowserRouter=BrowserRouter,exports.HashRouter=HashRouter,exports.Link=Link,exports.NavLink=NavLink,exports.MemoryRouter=MemoryRouter,exports.Prompt=Prompt,exports.Redirect=Redirect,exports.Route=Route,exports.Router=Router,exports.StaticRouter=StaticRouter,exports.Switch=Switch,exports.generatePath=generatePath,exports.matchPath=matchPath,exports.withRouter=withRouter,exports.renderRoutes=renderRoutes,exports.__RouterContext=context,exports.createBrowserHistory=createBrowserHistory,exports.createHashHistory=createHashHistory,exports.createMemoryHistory=createMemoryHistory,exports.createLocation=createLocation,exports.locationsAreEqual=locationsAreEqual,exports.parsePath=parsePath,exports.createPath=createPath;
