"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var resolvePathname=_interopDefault(require("resolve-pathname")),valueEqual=_interopDefault(require("value-equal"));require("tiny-warning");var invariant=_interopDefault(require("tiny-invariant")),createContext=_interopDefault(require("mini-create-react-context")),React=_interopDefault(require("react"));require("prop-types");var pathToRegexp=_interopDefault(require("path-to-regexp"));require("react-is");var hoistStatics=_interopDefault(require("hoist-non-react-statics"));function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t}).apply(this,arguments)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var n,a,o={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],0<=e.indexOf(n)||(o[n]=t[n]);return o}function addLeadingSlash(t){return"/"===t.charAt(0)?t:"/"+t}function stripLeadingSlash(t){return"/"===t.charAt(0)?t.substr(1):t}function hasBasename(t,e){return 0===t.toLowerCase().indexOf(e.toLowerCase())&&-1!=="/?#".indexOf(t.charAt(e.length))}function stripBasename(t,e){return hasBasename(t,e)?t.substr(e.length):t}function stripTrailingSlash(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t}function parsePath(t){var e=t||"/",n="",a="",o=e.indexOf("#");-1!==o&&(a=e.substr(o),e=e.substr(0,o));var r=e.indexOf("?");return-1!==r&&(n=e.substr(r),e=e.substr(0,r)),{pathname:e,search:"?"===n?"":n,hash:"#"===a?"":a}}function createPath(t){var e=t.pathname,n=t.search,a=t.hash,o=e||"/";return n&&"?"!==n&&(o+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(o+="#"===a.charAt(0)?a:"#"+a),o}function createLocation(t,e,n,a){var o;return"string"==typeof t?(o=parsePath(t)).state=e:(void 0===(o=_extends({},t)).pathname&&(o.pathname=""),o.search?"?"!==o.search.charAt(0)&&(o.search="?"+o.search):o.search="",o.hash?"#"!==o.hash.charAt(0)&&(o.hash="#"+o.hash):o.hash="",void 0!==e&&void 0===o.state&&(o.state=e)),n&&(o.key=n),a?o.pathname?"/"!==o.pathname.charAt(0)&&(o.pathname=resolvePathname(o.pathname,a.pathname)):o.pathname=a.pathname:o.pathname||(o.pathname="/"),o}function locationsAreEqual(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&valueEqual(t.state,e.state)}function createTransitionManager(){var r=null;var a=[];return{setPrompt:function(t){return r=t,function(){r===t&&(r=null)}},confirmTransitionTo:function(t,e,n,a){if(null!=r){var o="function"==typeof r?r(t,e):r;"string"==typeof o?"function"==typeof n?n(o,a):a(!0):a(!1!==o)}else a(!0)},appendListener:function(t){var e=!0;function n(){e&&t.apply(void 0,arguments)}return a.push(n),function(){e=!1,a=a.filter(function(t){return t!==n})}},notifyListeners:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];a.forEach(function(t){return t.apply(void 0,e)})}}}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);function getConfirmation(t,e){e(window.confirm(t))}function supportsHistory(){var t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}function supportsPopStateOnHashChange(){return-1===window.navigator.userAgent.indexOf("Trident")}function supportsGoWithoutReloadUsingHash(){return-1===window.navigator.userAgent.indexOf("Firefox")}function isExtraneousPopstateEvent(t){return void 0===t.state&&-1===navigator.userAgent.indexOf("CriOS")}var PopStateEvent="popstate",HashChangeEvent="hashchange";function getHistoryState(){try{return window.history.state||{}}catch(t){return{}}}function createBrowserHistory(t){void 0===t&&(t={}),canUseDOM||invariant(!1);var c=window.history,s=supportsHistory(),e=!supportsPopStateOnHashChange(),n=t,a=n.forceRefresh,u=void 0!==a&&a,o=n.getUserConfirmation,h=void 0===o?getConfirmation:o,r=n.keyLength,i=void 0===r?6:r,l=t.basename?stripTrailingSlash(addLeadingSlash(t.basename)):"";function p(t){var e=t||{},n=e.key,a=e.state,o=window.location,r=o.pathname+o.search+o.hash;return l&&(r=stripBasename(r,l)),createLocation(r,a,n)}function f(){return Math.random().toString(36).substr(2,i)}var d=createTransitionManager();function m(t){t&&"PUSH"==t.action?window.globalManger.push(t.location):window.globalManger.pop(),Object.assign(C,t),C.length=c.length,d.notifyListeners(C.location,C.action)}function v(t){isExtraneousPopstateEvent(t)||E(p(t.state))}function g(){E(p(getHistoryState()))}var y=!1;function E(e){if(y)y=!1,m();else{d.confirmTransitionTo(e,"POP",h,function(t){t?m({action:"POP",location:e}):function(t){var e=C.location,n=R.indexOf(e.key);-1===n&&(n=0);var a=R.indexOf(t.key);-1===a&&(a=0);var o=n-a;o&&(y=!0,_(o))}(e)})}}var P=p(getHistoryState());window.globalManger=[P];var R=[P.key];function x(t){return l+createPath(t)}function _(t){c.go(t)}var w=0;function S(t){1===(w+=t)&&1===t?(window.addEventListener(PopStateEvent,v),e&&window.addEventListener(HashChangeEvent,g)):0===w&&(window.removeEventListener(PopStateEvent,v),e&&window.removeEventListener(HashChangeEvent,g))}var T=!1;var C={length:c.length,action:"POP",location:P,createHref:x,push:function(t,e){var i=createLocation(t,e,f(),C.location);d.confirmTransitionTo(i,"PUSH",h,function(t){if(t){var e=x(i),n=i.key,a=i.state;if(s)if(c.pushState({key:n,state:a},null,e),u)window.location.href=e;else{var o=R.indexOf(C.location.key),r=R.slice(0,-1===o?0:o+1);r.push(i.key),R=r,m({action:"PUSH",location:i})}else window.location.href=e}})},replace:function(t,e){var r="REPLACE",i=createLocation(t,e,f(),C.location);d.confirmTransitionTo(i,r,h,function(t){if(t){var e=x(i),n=i.key,a=i.state;if(s)if(c.replaceState({key:n,state:a},null,e),u)window.location.replace(e);else{var o=R.indexOf(C.location.key);-1!==o&&(R[o]=i.key),m({action:r,location:i})}else window.location.replace(e)}})},go:_,goBack:function(){_(-1)},goForward:function(){_(1)},block:function(t){void 0===t&&(t=!1);var e=d.setPrompt(t);return T||(S(1),T=!0),function(){return T&&(T=!1,S(-1)),e()}},listen:function(t){var e=d.appendListener(t);return S(1),function(){S(-1),e()}}};return C}console.log("======== freya-history =========");var HashChangeEvent$1="hashchange",HashPathCoders={hashbang:{encodePath:function(t){return"!"===t.charAt(0)?t:"!/"+stripLeadingSlash(t)},decodePath:function(t){return"!"===t.charAt(0)?t.substr(1):t}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};function getHashPath(){var t=window.location.href,e=t.indexOf("#");return-1===e?"":t.substring(e+1)}function pushHashPath(t){window.location.hash=t}function replaceHashPath(t){var e=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=e?e:0)+"#"+t)}function createHashHistory(t){void 0===t&&(t={}),canUseDOM||invariant(!1);var e=window.history,n=(supportsGoWithoutReloadUsingHash(),t),a=n.getUserConfirmation,i=void 0===a?getConfirmation:a,o=n.hashType,r=void 0===o?"slash":o,c=t.basename?stripTrailingSlash(addLeadingSlash(t.basename)):"",s=HashPathCoders[r],u=s.encodePath,h=s.decodePath;function l(){var t=h(getHashPath());return c&&(t=stripBasename(t,c)),createLocation(t)}var p=createTransitionManager();function f(t){Object.assign(S,t),S.length=e.length,p.notifyListeners(S.location,S.action)}var d=!1,m=null;function v(){var t=getHashPath(),e=u(t);if(t!==e)replaceHashPath(e);else{var n=l(),a=S.location;if(!d&&locationsAreEqual(a,n))return;if(m===createPath(n))return;m=null,function(e){if(d)d=!1,f();else{p.confirmTransitionTo(e,"POP",i,function(t){t?f({action:"POP",location:e}):function(t){var e=S.location,n=P.lastIndexOf(createPath(e));-1===n&&(n=0);var a=P.lastIndexOf(createPath(t));-1===a&&(a=0);var o=n-a;o&&(d=!0,R(o))}(e)})}}(n)}}var g=getHashPath(),y=u(g);g!==y&&replaceHashPath(y);var E=l(),P=[createPath(E)];function R(t){e.go(t)}var x=0;function _(t){1===(x+=t)&&1===t?window.addEventListener(HashChangeEvent$1,v):0===x&&window.removeEventListener(HashChangeEvent$1,v)}var w=!1;var S={length:e.length,action:"POP",location:E,createHref:function(t){return"#"+u(c+createPath(t))},push:function(t,e){var r=createLocation(t,void 0,void 0,S.location);p.confirmTransitionTo(r,"PUSH",i,function(t){if(t){var e=createPath(r),n=u(c+e);if(getHashPath()!==n){m=e,pushHashPath(n);var a=P.lastIndexOf(createPath(S.location)),o=P.slice(0,-1===a?0:a+1);o.push(e),P=o,f({action:"PUSH",location:r})}else f()}})},replace:function(t,e){var o="REPLACE",r=createLocation(t,void 0,void 0,S.location);p.confirmTransitionTo(r,o,i,function(t){if(t){var e=createPath(r),n=u(c+e);getHashPath()!==n&&(m=e,replaceHashPath(n));var a=P.indexOf(createPath(S.location));-1!==a&&(P[a]=e),f({action:o,location:r})}})},go:R,goBack:function(){R(-1)},goForward:function(){R(1)},block:function(t){void 0===t&&(t=!1);var e=p.setPrompt(t);return w||(_(1),w=!0),function(){return w&&(w=!1,_(-1)),e()}},listen:function(t){var e=p.appendListener(t);return _(1),function(){_(-1),e()}}};return S}function clamp(t,e,n){return Math.min(Math.max(t,e),n)}function createMemoryHistory(t){void 0===t&&(t={});var e=t,o=e.getUserConfirmation,n=e.initialEntries,a=void 0===n?["/"]:n,r=e.initialIndex,i=void 0===r?0:r,c=e.keyLength,s=void 0===c?6:c,u=createTransitionManager();function h(t){Object.assign(v,t),v.length=v.entries.length,u.notifyListeners(v.location,v.action)}function l(){return Math.random().toString(36).substr(2,s)}var p=clamp(i,0,a.length-1),f=a.map(function(t){return createLocation(t,void 0,"string"==typeof t?l():t.key||l())}),d=createPath;function m(t){var e=clamp(v.index+t,0,v.entries.length-1),n=v.entries[e];u.confirmTransitionTo(n,"POP",o,function(t){t?h({action:"POP",location:n,index:e}):h()})}var v={length:f.length,action:"POP",location:f[p],index:p,entries:f,createHref:d,push:function(t,e){var a=createLocation(t,e,l(),v.location);u.confirmTransitionTo(a,"PUSH",o,function(t){if(t){var e=v.index+1,n=v.entries.slice(0);n.length>e?n.splice(e,n.length-e,a):n.push(a),h({action:"PUSH",location:a,index:e,entries:n})}})},replace:function(t,e){var n="REPLACE",a=createLocation(t,e,l(),v.location);u.confirmTransitionTo(a,n,o,function(t){t&&(v.entries[v.index]=a,h({action:n,location:a}))})},go:m,goBack:function(){m(-1)},goForward:function(){m(1)},canGo:function(t){var e=v.index+t;return 0<=e&&e<v.entries.length},block:function(t){return void 0===t&&(t=!1),u.setPrompt(t)},listen:function(t){return u.appendListener(t)}};return v}var createNamedContext=function(t){var e=createContext();return e.displayName=t,e},context=createNamedContext("Router"),Router=function(n){function t(t){var e;return(e=n.call(this,t)||this).state={location:t.history.location},e._isMounted=!1,e._pendingLocation=null,t.staticContext||(e.unlisten=t.history.listen(function(t){e._isMounted?e.setState({location:t}):e._pendingLocation=t})),e}_inheritsLoose(t,n),t.computeRootMatch=function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}};var e=t.prototype;return e.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},e.componentWillUnmount=function(){this.unlisten&&this.unlisten()},e.render=function(){return React.createElement(context.Provider,{children:this.props.children||null,value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}})},t}(React.Component),MemoryRouter=function(o){function t(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=o.call.apply(o,[this].concat(n))||this).history=createMemoryHistory(t.props),t}return _inheritsLoose(t,o),t.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},t}(React.Component),Lifecycle=function(t){function e(){return t.apply(this,arguments)||this}_inheritsLoose(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(t){this.props.onUpdate&&this.props.onUpdate.call(this,this,t)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},e}(React.Component);function Prompt(t){var a=t.message,e=t.when,o=void 0===e||e;return React.createElement(context.Consumer,null,function(t){if(t||invariant(!1),!o||t.staticContext)return null;var n=t.history.block;return React.createElement(Lifecycle,{onMount:function(t){t.release=n(a)},onUpdate:function(t,e){e.message!==a&&(t.release(),t.release=n(a))},onUnmount:function(t){t.release()},message:a})})}var cache={},cacheLimit=1e4,cacheCount=0;function compilePath(t){if(cache[t])return cache[t];var e=pathToRegexp.compile(t);return cacheCount<cacheLimit&&(cache[t]=e,cacheCount++),e}function generatePath(t,e){return void 0===t&&(t="/"),void 0===e&&(e={}),"/"===t?t:compilePath(t)(e,{pretty:!0})}function Redirect(t){var r=t.computedMatch,i=t.to,e=t.push,c=void 0!==e&&e;return React.createElement(context.Consumer,null,function(t){t||invariant(!1);var e=t.history,n=t.staticContext,a=c?e.push:e.replace,o=createLocation(r?"string"==typeof i?generatePath(i,r.params):_extends({},i,{pathname:generatePath(i.pathname,r.params)}):i);return n?(a(o),null):React.createElement(Lifecycle,{onMount:function(){a(o)},onUpdate:function(t,e){var n=createLocation(e.to);locationsAreEqual(n,_extends({},o,{key:n.key}))||a(o)},to:i})})}var cache$1={},cacheLimit$1=1e4,cacheCount$1=0;function compilePath$1(t,e){var n=""+e.end+e.strict+e.sensitive,a=cache$1[n]||(cache$1[n]={});if(a[t])return a[t];var o=[],r={regexp:pathToRegexp(t,o,e),keys:o};return cacheCount$1<cacheLimit$1&&(a[t]=r,cacheCount$1++),r}function matchPath(u,t){void 0===t&&(t={}),"string"!=typeof t&&!Array.isArray(t)||(t={path:t});var e=t,n=e.path,a=e.exact,h=void 0!==a&&a,o=e.strict,l=void 0!==o&&o,r=e.sensitive,p=void 0!==r&&r;return[].concat(n).reduce(function(t,e){if(!e)return null;if(t)return t;var n=compilePath$1(e,{end:h,strict:l,sensitive:p}),a=n.regexp,o=n.keys,r=a.exec(u);if(!r)return null;var i=r[0],c=r.slice(1),s=u===i;return h&&!s?null:{path:e,url:"/"===e&&""===i?"/":i,isExact:s,params:o.reduce(function(t,e,n){return t[e.name]=c[n],t},{})}},null)}function isEmptyChildren(t){return 0===React.Children.count(t)}var Route=function(t){function e(){return t.apply(this,arguments)||this}return _inheritsLoose(e,t),e.prototype.render=function(){var c=this;return React.createElement(context.Consumer,null,function(t){t||invariant(!1);var e=c.props.location||t.location,n=_extends({},t,{location:e,match:c.props.computedMatch?c.props.computedMatch:c.props.path?matchPath(e.pathname,c.props):t.match}),a=c.props,o=a.children,r=a.component,i=a.render;return Array.isArray(o)&&0===o.length&&(o=null),"function"==typeof o&&void 0===(o=o(n))&&(o=null),React.createElement(context.Provider,{value:n},o&&!isEmptyChildren(o)?o:n.match?r?React.createElement(r,n):i?i(n):null:null)})},e}(React.Component);function addLeadingSlash$1(t){return"/"===t.charAt(0)?t:"/"+t}function addBasename(t,e){return t?_extends({},e,{pathname:addLeadingSlash$1(t)+e.pathname}):e}function stripBasename$1(t,e){if(!t)return e;var n=addLeadingSlash$1(t);return 0!==e.pathname.indexOf(n)?e:_extends({},e,{pathname:e.pathname.substr(n.length)})}function createURL(t){return"string"==typeof t?t:createPath(t)}function staticHandler(t){return function(){invariant(!1)}}function noop(){}var StaticRouter=function(o){function t(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))||this).handlePush=function(t){return e.navigateTo(t,"PUSH")},e.handleReplace=function(t){return e.navigateTo(t,"REPLACE")},e.handleListen=function(){return noop},e.handleBlock=function(){return noop},e}_inheritsLoose(t,o);var e=t.prototype;return e.navigateTo=function(t,e){var n=this.props,a=n.basename,o=void 0===a?"":a,r=n.context,i=void 0===r?{}:r;i.action=e,i.location=addBasename(o,createLocation(t)),i.url=createURL(i.location)},e.render=function(){var t=this.props,e=t.basename,n=void 0===e?"":e,a=t.context,o=void 0===a?{}:a,r=t.location,i=void 0===r?"/":r,c=_objectWithoutPropertiesLoose(t,["basename","context","location"]),s={createHref:function(t){return addLeadingSlash$1(n+createURL(t))},action:"POP",location:stripBasename$1(n,createLocation(i)),push:this.handlePush,replace:this.handleReplace,go:staticHandler("go"),goBack:staticHandler("goBack"),goForward:staticHandler("goForward"),listen:this.handleListen,block:this.handleBlock};return React.createElement(Router,_extends({},c,{history:s,staticContext:o}))},t}(React.Component),push_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},push_current={zIndex:-1,position:"absolute",left:0,top:0},gesture_current={zIndex:-1,position:"absolute",left:0,top:0},pop_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},pop_current={position:"absolute",left:0,top:0,boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)",background:"#fff"},Switch=function(t){function e(){return t.apply(this,arguments)||this}return _inheritsLoose(e,t),e.prototype.render=function(){var e=this;return React.createElement(context.Consumer,null,function(t){return React.createElement(AnimateRoute,_extends({},e.props,{adapt:t}))})},e}(React.Component),isWebView="undefined"!=typeof navigator&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),AnimateRoute=function(a){function t(){for(var h,t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(h=a.call.apply(a,[this].concat(e))||this).currentPage=null,h.matchPage=null,h.action="",h.SCREEN_WIDTH=window.innerWidth,h.MATCH_SCREEN_OFFSET=h.SCREEN_WIDTH,h.BOTTOM_SCREEN_OFFSET=.3*-h.SCREEN_WIDTH,h.BACK_ACTIVE_POSITION=.1*h.SCREEN_WIDTH,h.SIZE={width:window.innerWidth,height:window.innerHeight},h.disabledBodyTouch=function(t){t._isScroller||t.preventDefault()},h.toggleBodyTouch=function(t){t?(console.log("======== enable ========="),document.body.removeEventListener("touchmove",h.disabledBodyTouch)):(console.log("======== disabled ========="),document.body.addEventListener("touchmove",h.disabledBodyTouch,{passive:!1}))},h.easeInQuad=function(t,e,n,a){var o=t/a;return e+n*(o*o)},h.easeOutQuad=function(t,e,n,a){var o=t/a;return e+n*(-o*o+2*o)},h.easeInOut=function(t,e,n,a){if(t<a/2)return h.easeInQuad(t,e,n/2,a/2);var o=t-a/2,r=e+n/2;return h.easeOutQuad(o,r,n/2,a/2)},h.animate=function(t){var o=t.begin,r=t.end,i=t.ref,c=t.done,e=t.type,n=void 0===e?"ease-in-out":e,a=t.duration,s=void 0===a?.1:a,u="ease-in-out"==n?h.easeInOut:"ease-in"==n?h.easeInQuad:"ease-out"==n?h.easeOutQuad:h.easeInOut;!function e(n){var a=u(n,o,r-o,s);requestAnimationFrame(function(t){i.style.transform="translate3d("+a+"px,0px,0)",a!=r?e(n+.01):c&&c()})}(0)},h.animatePop=function(){h.animate({begin:h.BOTTOM_SCREEN_OFFSET,end:0,ref:h.matchRef}),h.animate({begin:0,end:h.MATCH_SCREEN_OFFSET,ref:h.currentRef,done:function(t){return h.currentRef.style.display="none"}})},h.animatePush=function(){h.animate({begin:h.MATCH_SCREEN_OFFSET,end:0,ref:h.matchRef}),h.animate({begin:0,end:h.BOTTOM_SCREEN_OFFSET,ref:h.currentRef})},h.findMatchElement=function(n){var a,o,r=h.props.location||n.location;return h.action=n.history.action,h.currentPage=h.matchPage,React.Children.forEach(h.props.children,function(t){if(null==o&&React.isValidElement(t)){var e=(a=t).props.path||t.props.from;o=e?matchPath(r.pathname,_extends({},t.props,{path:e})):n.match}}),h.matchPage=React.cloneElement(a,{location:r,computedMatch:o}),o},h.setTransform=function(t){h.matchRef.style.transform="translate3d("+t+"px,0px,0)",h.setBottomTransform(t)},h.setBottomTransform=function(t){var e=h.BOTTOM_SCREEN_OFFSET+.3*t;h.currentRef.style.transform="translate3d("+e+"px,0px,0)"},h.onTouchStart=function(t){document.getElementById("root").style.overflow="hidden",h._ScreenX=h._startScreenX=t.touches[0].screenX,h.gestureBackActive=h._startScreenX<h.BACK_ACTIVE_POSITION,h._lastScreenX=h._lastScreenX||0,h.startTime=+new Date},h.onTouchMove=function(t){if(h.gestureBackActive){var e=t.touches[0].screenX;if(!(h._startScreenX>e)){t.preventDefault();var n=Math.round(e-h._ScreenX);h._ScreenX=e,h._lastScreenX+=n,h.setTransform(h._lastScreenX),isWebView&&t.changedTouches[0].clientY<0&&h.onTouchEnd()}}},h.reset=function(){h.animate({begin:h._lastScreenX,end:0,ref:h.matchRef})},h.onTouchEnd=function(t){if(h.gestureBackActive){var e=+new Date-h.startTime;document.getElementById("root").style.overflow=null,e<300&&h._lastScreenX>.2*h.SCREEN_WIDTH?(h.animate({begin:h.BOTTOM_SCREEN_OFFSET+.3*h._lastScreenX,end:0,ref:h.currentRef,duration:.05}),h.animate({begin:h._lastScreenX,end:h.SCREEN_WIDTH,ref:h.matchRef,done:h.props.adapt.history.goBack,type:"ease-out",duration:.05}),h._lastScreenX=0,h.fromGesture=!0,h.gestureBackActive=!1):(h._lastScreenX<h.SCREEN_WIDTH/2?h.reset():(h.animate({begin:h.BOTTOM_SCREEN_OFFSET+.3*h._lastScreenX,end:0,ref:h.currentRef,duration:.05}),h.animate({begin:h._lastScreenX,end:h.SCREEN_WIDTH,ref:h.matchRef,done:h.props.adapt.history.goBack,type:"ease-out",duration:.05}),h.fromGesture=!0),h.gestureBackActive=!1,h._lastScreenX=0)}},h.renderGesture=function(){return window.globalManger.length<2?(h.toggleBodyTouch(!0),h.matchPage):(h.toggleBodyTouch(!1),React.Children.forEach(h.props.children,function(t){if(null==n&&React.isValidElement(t)){var e=(a=t).props.path||t.props.from;n=matchPath(window.globalManger[window.globalManger.length-2].pathname,_extends({},t.props,{path:e}))}}),h.currentPage=React.cloneElement(a,{location:window.globalManger[window.globalManger.length-2],computedMatch:n}),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d("+h.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,{gesture_current:gesture_current}),key:Math.random(),ref:function(t){return h.currentRef=t}},h.currentPage),React.createElement("div",{onTouchStart:h.onTouchStart,onTouchMove:h.onTouchMove,onTouchEnd:h.onTouchEnd,style:_extends({},h.SIZE,pop_match),key:Math.random(),ref:function(t){return h.matchRef=t}},h.matchPage)));var n,a},h.renderPop=function(){if(!h.currentPage)return h.matchPage;if(h.fromGesture)return h.renderGesture();var t=1==window.globalManger.length;return h.toggleBodyTouch(t),React.createElement(React.Fragment,null,React.createElement("div",{onTouchStart:t?null:h.onTouchStart,onTouchMove:t?null:h.onTouchMove,onTouchEnd:t?null:h.onTouchEnd,style:_extends({transform:"translate3d("+h.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,pop_match),key:Math.random(),ref:function(t){return h.matchRef=t}},h.matchPage),React.createElement("div",{style:_extends({transform:"translate3d(0px,0px,0)"},h.SIZE,pop_current),key:Math.random(),ref:function(t){return h.currentRef=t}},h.currentPage))},h.renderPush=function(){var t=1==window.globalManger.length;return h.toggleBodyTouch(t),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d(0px,0px,0)"},h.SIZE,push_current),key:Math.random(),ref:function(t){return h.currentRef=t}},h.currentPage),React.createElement("div",{onTouchStart:h.onTouchStart,onTouchMove:h.onTouchMove,onTouchEnd:h.onTouchEnd,style:_extends({transform:"translate3d("+h.MATCH_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,push_match),key:Math.random(),ref:function(t){return h.matchRef=t}},h.matchPage))},h}_inheritsLoose(t,a);var e=t.prototype;return e.componentWillMount=function(){this.match=this.findMatchElement(this.props.adapt)},e.componentWillReceiveProps=function(t,e){this.match=this.findMatchElement(t.adapt)},e.componentDidUpdate=function(t,e,n){this.currentPage===this.matchPage||this.fromGesture||("PUSH"==this.action?this.animatePush():this.animatePop()),this.fromGesture=!1},e.render=function(){return this.match?"POP"==this.action?this.renderPop():this.renderPush():null},t}(React.Component);function withRouter(a){function t(t){var e=t.wrappedComponentRef,n=_objectWithoutPropertiesLoose(t,["wrappedComponentRef"]);return React.createElement(context.Consumer,null,function(t){return t||invariant(!1),React.createElement(a,_extends({},n,t,{ref:e}))})}var e="withRouter("+(a.displayName||a.name)+")";return t.displayName=e,t.WrappedComponent=a,hoistStatics(t,a)}var BrowserRouter=function(o){function t(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=o.call.apply(o,[this].concat(n))||this).history=createBrowserHistory(t.props),t}return _inheritsLoose(t,o),t.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},t}(React.Component),HashRouter=function(o){function t(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=o.call.apply(o,[this].concat(n))||this).history=createHashHistory(t.props),t}return _inheritsLoose(t,o),t.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},t}(React.Component),resolveToLocation=function(t,e){return"function"==typeof t?t(e):t},normalizeToLocation=function(t,e){return"string"==typeof t?createLocation(t,null,null,e):t};function isModifiedEvent(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function LinkAnchor(t){var e=t.innerRef,n=t.navigate,a=t.onClick,o=_objectWithoutPropertiesLoose(t,["innerRef","navigate","onClick"]),r=o.target;return React.createElement("a",_extends({},o,{ref:e,onClick:function(e){try{a&&a(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||r&&"_self"!==r||isModifiedEvent(e)||(e.preventDefault(),n())}}))}function Link(t){var e=t.component,o=void 0===e?LinkAnchor:e,r=t.replace,i=t.to,c=_objectWithoutPropertiesLoose(t,["component","replace","to"]);return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var n=e.history,t=normalizeToLocation(resolveToLocation(i,e.location),e.location),a=t?n.createHref(t):"";return React.createElement(o,_extends({},c,{href:a,navigate:function(){var t=resolveToLocation(i,e.location);(r?n.replace:n.push)(t)}}))})}function joinClassnames(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.filter(function(t){return t}).join(" ")}function NavLink(t){var e=t["aria-current"],h=void 0===e?"page":e,n=t.activeClassName,l=void 0===n?"active":n,p=t.activeStyle,f=t.className,d=t.exact,m=t.isActive,v=t.location,g=t.strict,y=t.style,E=t.to,P=_objectWithoutPropertiesLoose(t,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","strict","style","to"]);return React.createElement(context.Consumer,null,function(t){t||invariant(!1);var e=v||t.location,n=e.pathname,a=normalizeToLocation(resolveToLocation(E,e),e),o=a.pathname,r=o&&o.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),i=r?matchPath(n,{path:r,exact:d,strict:g}):null,c=!!(m?m(i,t.location):i),s=c?joinClassnames(f,l):f,u=c?_extends({},y,p):y;return React.createElement(Link,_extends({"aria-current":c&&h||null,className:s,style:u,to:a},P))})}exports.BrowserRouter=BrowserRouter,exports.HashRouter=HashRouter,exports.Link=Link,exports.NavLink=NavLink,exports.MemoryRouter=MemoryRouter,exports.Prompt=Prompt,exports.Redirect=Redirect,exports.Route=Route,exports.Router=Router,exports.StaticRouter=StaticRouter,exports.Switch=Switch,exports.generatePath=generatePath,exports.matchPath=matchPath,exports.withRouter=withRouter,exports.__RouterContext=context;
