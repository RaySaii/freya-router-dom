"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var resolvePathname=_interopDefault(require("resolve-pathname")),valueEqual=_interopDefault(require("value-equal"));require("tiny-warning");var invariant=_interopDefault(require("tiny-invariant")),createContext=_interopDefault(require("mini-create-react-context")),React=_interopDefault(require("react"));require("prop-types");var pathToRegexp=_interopDefault(require("path-to-regexp"));require("react-is");var hoistStatics=_interopDefault(require("hoist-non-react-statics")),reactKeepAlive=require("react-keep-alive");function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||(a[n]=e[n]);return a}function addLeadingSlash(e){return"/"===e.charAt(0)?e:"/"+e}function stripLeadingSlash(e){return"/"===e.charAt(0)?e.substr(1):e}function hasBasename(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}function stripBasename(e,t){return hasBasename(e,t)?e.substr(t.length):e}function stripTrailingSlash(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function parsePath(e){var t=e||"/",n="",o="",a=t.indexOf("#");-1!==a&&(o=t.substr(a),t=t.substr(0,a));var r=t.indexOf("?");return-1!==r&&(n=t.substr(r),t=t.substr(0,r)),{pathname:t,search:"?"===n?"":n,hash:"#"===o?"":o}}function createPath(e){var t=e.pathname,n=e.search,o=e.hash,a=t||"/";return n&&"?"!==n&&(a+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(a+="#"===o.charAt(0)?o:"#"+o),a}function createLocation(e,t,n,o){var a;return"string"==typeof e?(a=parsePath(e)).state=t:(void 0===(a=_extends({},e)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==t&&void 0===a.state&&(a.state=t)),n&&(a.key=n),o?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=resolvePathname(a.pathname,o.pathname)):a.pathname=o.pathname:a.pathname||(a.pathname="/"),a}function locationsAreEqual(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&valueEqual(e.state,t.state)}function createTransitionManager(){var r=null;var o=[];return{setPrompt:function(e){return r=e,function(){r===e&&(r=null)}},confirmTransitionTo:function(e,t,n,o){if(null!=r){var a="function"==typeof r?r(e,t):r;"string"==typeof a?"function"==typeof n?n(a,o):o(!0):o(!1!==a)}else o(!0)},appendListener:function(e){var t=!0;function n(){t&&e.apply(void 0,arguments)}return o.push(n),function(){t=!1,o=o.filter(function(e){return e!==n})}},notifyListeners:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.forEach(function(e){return e.apply(void 0,t)})}}}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);function getConfirmation(e,t){t(window.confirm(e))}function supportsHistory(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}function supportsPopStateOnHashChange(){return-1===window.navigator.userAgent.indexOf("Trident")}function supportsGoWithoutReloadUsingHash(){return-1===window.navigator.userAgent.indexOf("Firefox")}function isExtraneousPopstateEvent(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")}var PopStateEvent="popstate",HashChangeEvent="hashchange";function getHistoryState(){try{return window.history.state||{}}catch(e){return{}}}function createBrowserHistory(e){void 0===e&&(e={}),canUseDOM||invariant(!1);var c=window.history,s=supportsHistory(),t=!supportsPopStateOnHashChange(),n=null,o=e,a=o.forceRefresh,u=void 0!==a&&a,r=o.getUserConfirmation,h=void 0===r?getConfirmation:r,i=o.keyLength,l=void 0===i?6:i,p=e.basename?stripTrailingSlash(addLeadingSlash(e.basename)):"";function d(e){var t=e||{},n=t.key,o=t.state,a=window.location,r=a.pathname+a.search+a.hash;return p&&(r=stripBasename(r,p)),createLocation(r,o,n)}function f(){return Math.random().toString(36).substr(2,l)}var m=createTransitionManager();function v(e){e&&"PUSH"==e.action?window.globalManger.push(e.location):"REPLACE"==e.action?(window.globalManger.pop(),window.globalManger.push(e.location)):"POP"==e.action&&(n?(window.globalManger=window.globalManger.slice(0,n),n=null):window.globalManger.pop()),Object.assign(C,e),C.length=c.length,m.notifyListeners(C.location,C.action)}function g(e){isExtraneousPopstateEvent(e)||P(d(e.state))}function E(){P(d(getHistoryState()))}var y=!1;function P(t){if(y)y=!1,v();else{m.confirmTransitionTo(t,"POP",h,function(e){e?v({action:"POP",location:t}):function(e){var t=C.location,n=w.indexOf(t.key);-1===n&&(n=0);var o=w.indexOf(e.key);-1===o&&(o=0);var a=n-o;a&&(y=!0,L(a))}(t)})}}var R=d(getHistoryState());window.globalManger=[R];var w=[R.key];function x(e){return p+createPath(e)}function L(e){n=e,c.go(e)}var _=0;function S(e){1===(_+=e)&&1===e?(window.addEventListener(PopStateEvent,g),t&&window.addEventListener(HashChangeEvent,E)):0===_&&(window.removeEventListener(PopStateEvent,g),t&&window.removeEventListener(HashChangeEvent,E))}var T=!1;var C={length:c.length,action:"POP",location:R,createHref:x,push:function(e,t){var i=createLocation(e,t,f(),C.location);m.confirmTransitionTo(i,"PUSH",h,function(e){if(e){var t=x(i),n=i.key,o=i.state;if(s)if(c.pushState({key:n,state:o},null,t),u)window.location.href=t;else{var a=w.indexOf(C.location.key),r=w.slice(0,-1===a?0:a+1);r.push(i.key),w=r,v({action:"PUSH",location:i})}else window.location.href=t}})},replace:function(e,t){var r="REPLACE",i=createLocation(e,t,f(),C.location);m.confirmTransitionTo(i,r,h,function(e){if(e){var t=x(i),n=i.key,o=i.state;if(s)if(c.replaceState({key:n,state:o},null,t),u)window.location.replace(t);else{var a=w.indexOf(C.location.key);-1!==a&&(w[a]=i.key),v({action:r,location:i})}else window.location.replace(t)}})},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var t=m.setPrompt(e);return T||(S(1),T=!0),function(){return T&&(T=!1,S(-1)),t()}},listen:function(e){var t=m.appendListener(e);return S(1),function(){S(-1),t()}}};return C}console.log("======== freya-history =========");var HashChangeEvent$1="hashchange",HashPathCoders={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+stripLeadingSlash(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};function getHashPath(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function pushHashPath(e){window.location.hash=e}function replaceHashPath(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=t?t:0)+"#"+e)}function createHashHistory(e){void 0===e&&(e={}),canUseDOM||invariant(!1);var t=window.history,n=(supportsGoWithoutReloadUsingHash(),e),o=n.getUserConfirmation,i=void 0===o?getConfirmation:o,a=n.hashType,r=void 0===a?"slash":a,c=e.basename?stripTrailingSlash(addLeadingSlash(e.basename)):"",s=HashPathCoders[r],u=s.encodePath,h=s.decodePath;function l(){var e=h(getHashPath());return c&&(e=stripBasename(e,c)),createLocation(e)}var p=createTransitionManager();function d(e){Object.assign(_,e),_.length=t.length,p.notifyListeners(_.location,_.action)}var f=!1,m=null;function v(){var e=getHashPath(),t=u(e);if(e!==t)replaceHashPath(t);else{var n=l(),o=_.location;if(!f&&locationsAreEqual(o,n))return;if(m===createPath(n))return;m=null,function(t){if(f)f=!1,d();else{p.confirmTransitionTo(t,"POP",i,function(e){e?d({action:"POP",location:t}):function(e){var t=_.location,n=P.lastIndexOf(createPath(t));-1===n&&(n=0);var o=P.lastIndexOf(createPath(e));-1===o&&(o=0);var a=n-o;a&&(f=!0,R(a))}(t)})}}(n)}}var g=getHashPath(),E=u(g);g!==E&&replaceHashPath(E);var y=l(),P=[createPath(y)];function R(e){t.go(e)}var w=0;function x(e){1===(w+=e)&&1===e?window.addEventListener(HashChangeEvent$1,v):0===w&&window.removeEventListener(HashChangeEvent$1,v)}var L=!1;var _={length:t.length,action:"POP",location:y,createHref:function(e){return"#"+u(c+createPath(e))},push:function(e,t){var r=createLocation(e,void 0,void 0,_.location);p.confirmTransitionTo(r,"PUSH",i,function(e){if(e){var t=createPath(r),n=u(c+t);if(getHashPath()!==n){m=t,pushHashPath(n);var o=P.lastIndexOf(createPath(_.location)),a=P.slice(0,-1===o?0:o+1);a.push(t),P=a,d({action:"PUSH",location:r})}else d()}})},replace:function(e,t){var a="REPLACE",r=createLocation(e,void 0,void 0,_.location);p.confirmTransitionTo(r,a,i,function(e){if(e){var t=createPath(r),n=u(c+t);getHashPath()!==n&&(m=t,replaceHashPath(n));var o=P.indexOf(createPath(_.location));-1!==o&&(P[o]=t),d({action:a,location:r})}})},go:R,goBack:function(){R(-1)},goForward:function(){R(1)},block:function(e){void 0===e&&(e=!1);var t=p.setPrompt(e);return L||(x(1),L=!0),function(){return L&&(L=!1,x(-1)),t()}},listen:function(e){var t=p.appendListener(e);return x(1),function(){x(-1),t()}}};return _}function clamp(e,t,n){return Math.min(Math.max(e,t),n)}function createMemoryHistory(e){void 0===e&&(e={});var t=e,a=t.getUserConfirmation,n=t.initialEntries,o=void 0===n?["/"]:n,r=t.initialIndex,i=void 0===r?0:r,c=t.keyLength,s=void 0===c?6:c,u=createTransitionManager();function h(e){Object.assign(v,e),v.length=v.entries.length,u.notifyListeners(v.location,v.action)}function l(){return Math.random().toString(36).substr(2,s)}var p=clamp(i,0,o.length-1),d=o.map(function(e){return createLocation(e,void 0,"string"==typeof e?l():e.key||l())}),f=createPath;function m(e){var t=clamp(v.index+e,0,v.entries.length-1),n=v.entries[t];u.confirmTransitionTo(n,"POP",a,function(e){e?h({action:"POP",location:n,index:t}):h()})}var v={length:d.length,action:"POP",location:d[p],index:p,entries:d,createHref:f,push:function(e,t){var o=createLocation(e,t,l(),v.location);u.confirmTransitionTo(o,"PUSH",a,function(e){if(e){var t=v.index+1,n=v.entries.slice(0);n.length>t?n.splice(t,n.length-t,o):n.push(o),h({action:"PUSH",location:o,index:t,entries:n})}})},replace:function(e,t){var n="REPLACE",o=createLocation(e,t,l(),v.location);u.confirmTransitionTo(o,n,a,function(e){e&&(v.entries[v.index]=o,h({action:n,location:o}))})},go:m,goBack:function(){m(-1)},goForward:function(){m(1)},canGo:function(e){var t=v.index+e;return 0<=t&&t<v.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return v}var createNamedContext=function(e){var t=createContext();return t.displayName=e,t},context=createNamedContext("Router"),Router=function(n){function e(e){var t;return(t=n.call(this,e)||this).state={location:e.history.location},t._isMounted=!1,t._pendingLocation=null,e.staticContext||(t.unlisten=e.history.listen(function(e){t._isMounted?t.setState({location:e}):t._pendingLocation=e})),t}_inheritsLoose(e,n),e.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var t=e.prototype;return t.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},t.componentWillUnmount=function(){this.unlisten&&this.unlisten()},t.render=function(){return React.createElement(context.Provider,{children:this.props.children||null,value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}})},e}(React.Component),MemoryRouter=function(a){function e(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))||this).history=createMemoryHistory(e.props),e}return _inheritsLoose(e,a),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),Lifecycle=function(e){function t(){return e.apply(this,arguments)||this}_inheritsLoose(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(React.Component);function Prompt(e){var o=e.message,t=e.when,a=void 0===t||t;return React.createElement(context.Consumer,null,function(e){if(e||invariant(!1),!a||e.staticContext)return null;var n=e.history.block;return React.createElement(Lifecycle,{onMount:function(e){e.release=n(o)},onUpdate:function(e,t){t.message!==o&&(e.release(),e.release=n(o))},onUnmount:function(e){e.release()},message:o})})}var cache={},cacheLimit=1e4,cacheCount=0;function compilePath(e){if(cache[e])return cache[e];var t=pathToRegexp.compile(e);return cacheCount<cacheLimit&&(cache[e]=t,cacheCount++),t}function generatePath(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:compilePath(e)(t,{pretty:!0})}function Redirect(e){var r=e.computedMatch,i=e.to,t=e.push,c=void 0!==t&&t;return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=e.history,n=e.staticContext,o=c?t.push:t.replace,a=createLocation(r?"string"==typeof i?generatePath(i,r.params):_extends({},i,{pathname:generatePath(i.pathname,r.params)}):i);return n?(o(a),null):React.createElement(Lifecycle,{onMount:function(){o(a)},onUpdate:function(e,t){var n=createLocation(t.to);locationsAreEqual(n,_extends({},a,{key:n.key}))||o(a)},to:i})})}var cache$1={},cacheLimit$1=1e4,cacheCount$1=0;function compilePath$1(e,t){var n=""+t.end+t.strict+t.sensitive,o=cache$1[n]||(cache$1[n]={});if(o[e])return o[e];var a=[],r={regexp:pathToRegexp(e,a,t),keys:a};return cacheCount$1<cacheLimit$1&&(o[e]=r,cacheCount$1++),r}function matchPath(u,e){void 0===e&&(e={}),"string"!=typeof e&&!Array.isArray(e)||(e={path:e});var t=e,n=t.path,o=t.exact,h=void 0!==o&&o,a=t.strict,l=void 0!==a&&a,r=t.sensitive,p=void 0!==r&&r;return[].concat(n).reduce(function(e,t){if(!t)return null;if(e)return e;var n=compilePath$1(t,{end:h,strict:l,sensitive:p}),o=n.regexp,a=n.keys,r=o.exec(u);if(!r)return null;var i=r[0],c=r.slice(1),s=u===i;return h&&!s?null:{path:t,url:"/"===t&&""===i?"/":i,isExact:s,params:a.reduce(function(e,t,n){return e[t.name]=c[n],e},{})}},null)}function isEmptyChildren(e){return 0===React.Children.count(e)}var Route=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var c=this;return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=c.props.location||e.location,n=_extends({},e,{location:t,match:c.props.computedMatch?c.props.computedMatch:c.props.path?matchPath(t.pathname,c.props):e.match}),o=c.props,a=o.children,r=o.component,i=o.render;return Array.isArray(a)&&0===a.length&&(a=null),"function"==typeof a&&void 0===(a=a(n))&&(a=null),React.createElement(context.Provider,{value:n},a&&!isEmptyChildren(a)?a:n.match?r?React.createElement(r,n):i?i(n):null:null)})},t}(React.Component);function addLeadingSlash$1(e){return"/"===e.charAt(0)?e:"/"+e}function addBasename(e,t){return e?_extends({},t,{pathname:addLeadingSlash$1(e)+t.pathname}):t}function stripBasename$1(e,t){if(!e)return t;var n=addLeadingSlash$1(e);return 0!==t.pathname.indexOf(n)?t:_extends({},t,{pathname:t.pathname.substr(n.length)})}function createURL(e){return"string"==typeof e?e:createPath(e)}function staticHandler(e){return function(){invariant(!1)}}function noop(){}var StaticRouter=function(a){function e(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=a.call.apply(a,[this].concat(n))||this).handlePush=function(e){return t.navigateTo(e,"PUSH")},t.handleReplace=function(e){return t.navigateTo(e,"REPLACE")},t.handleListen=function(){return noop},t.handleBlock=function(){return noop},t}_inheritsLoose(e,a);var t=e.prototype;return t.navigateTo=function(e,t){var n=this.props,o=n.basename,a=void 0===o?"":o,r=n.context,i=void 0===r?{}:r;i.action=t,i.location=addBasename(a,createLocation(e)),i.url=createURL(i.location)},t.render=function(){var e=this.props,t=e.basename,n=void 0===t?"":t,o=e.context,a=void 0===o?{}:o,r=e.location,i=void 0===r?"/":r,c=_objectWithoutPropertiesLoose(e,["basename","context","location"]),s={createHref:function(e){return addLeadingSlash$1(n+createURL(e))},action:"POP",location:stripBasename$1(n,createLocation(i)),push:this.handlePush,replace:this.handleReplace,go:staticHandler("go"),goBack:staticHandler("goBack"),goForward:staticHandler("goForward"),listen:this.handleListen,block:this.handleBlock};return React.createElement(Router,_extends({},c,{history:s,staticContext:a}))},e}(React.Component),push_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},push_pre={zIndex:-1,position:"absolute",left:0,top:0},gesture_pre={zIndex:-1,position:"absolute",left:0,top:0},pop_match={background:"#fff",boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)"},pop_pre={position:"absolute",left:0,top:0,boxShadow:"-2px 0 5px rgba(0, 0, 0, .2)",background:"#fff"},Switch=function(e){function t(){return e.apply(this,arguments)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var t=this;return React.createElement(context.Consumer,null,function(e){return React.createElement(AnimateRoute,_extends({},t.props,{adapt:e}))})},t}(React.Component),isWebView="undefined"!=typeof navigator&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),AnimateRoute=function(o){function e(){for(var h,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(h=o.call.apply(o,[this].concat(t))||this).prePage=null,h.matchPage=null,h.action="",h.canAnimate=!0,h.SCREEN_WIDTH=window.innerWidth,h.MATCH_SCREEN_OFFSET=h.SCREEN_WIDTH,h.BOTTOM_SCREEN_OFFSET=.3*-h.SCREEN_WIDTH,h.BACK_ACTIVE_POSITION=.1*h.SCREEN_WIDTH,h.SIZE={width:window.innerWidth,minHeight:window.innerHeight},h.easeInQuad=function(e,t,n,o){var a=e/o;return t+n*(a*a)},h.easeOutQuad=function(e,t,n,o){var a=e/o;return t+n*(-a*a+2*a)},h.easeInOut=function(e,t,n,o){if(e<o/2)return h.easeInQuad(e,t,n/2,o/2);var a=e-o/2,r=t+n/2;return h.easeOutQuad(a,r,n/2,o/2)},h.animate=function(e){var a=e.begin,r=e.end,i=e.ref,c=e.done,t=e.type,n=void 0===t?"ease-in-out":t,o=e.duration,s=void 0===o?.1:o,u="ease-in-out"==n?h.easeInOut:"ease-in"==n?h.easeInQuad:"ease-out"==n?h.easeOutQuad:h.easeInOut;!function t(n){var o=u(n,a,r-a,s);requestAnimationFrame(function(e){i.style.transform="translate3d("+o+"px,0px,0)",o!=r?t(n+.01):c&&c()})}(0)},h.animatePop=function(){h.animate({begin:h.BOTTOM_SCREEN_OFFSET,end:0,ref:h.matchRef}),h.animate({begin:0,end:h.MATCH_SCREEN_OFFSET,ref:h.preRef,done:function(e){return h.preRef.style.display="none"}})},h.animatePush=function(){h.animate({begin:h.MATCH_SCREEN_OFFSET,end:0,ref:h.matchRef}),h.animate({begin:0,end:h.BOTTOM_SCREEN_OFFSET,ref:h.preRef,done:h.hideBottom})},h.findMatchElement=function(n){var o,a;return n=n||h.props.location||h.props.adapt.location,React.Children.forEach(h.props.children,function(e){if(null==a&&React.isValidElement(e)){var t=(o=e).props.path||e.props.from;a=t?matchPath(n.pathname,_extends({},e.props,{path:t})):h.props.adapt.match}}),a?React.cloneElement(o,{location:n,computedMatch:a}):null},h.findMatchElementByLocation=function(e){return h.findMatchElement(e)},h.setTransform=function(e){h.matchRef.style.transform="translate3d("+e+"px,0px,0)",h.setBottomTransform(e)},h.setBottomTransform=function(e){var t=h.BOTTOM_SCREEN_OFFSET+.3*e;h.preRef.style.transform="translate3d("+t+"px,0px,0)"},h.hideBottom=function(){h.preRef.style.opacity=0},h.showBottom=function(){h.preRef.style.opacity=null},h.onTouchStart=function(e){document.getElementById("root").style.overflow="hidden",h._ScreenX=h._startScreenX=e.touches[0].screenX,h.gestureBackActive=h._startScreenX<h.BACK_ACTIVE_POSITION,h.gestureBackActive&&(h.showBottom(),h._lastScreenX=h._lastScreenX||0,h.startTime=+new Date)},h.onTouchMove=function(e){if(h.gestureBackActive){var t=e.touches[0].screenX;if(!(h._startScreenX>t)){e.preventDefault();var n=Math.round(t-h._ScreenX);h._ScreenX=t,h._lastScreenX+=n,h.setTransform(h._lastScreenX),isWebView&&e.changedTouches[0].clientY<0&&h.onTouchEnd()}}},h.reset=function(){h.animate({begin:h._lastScreenX,end:0,ref:h.matchRef,done:h.hideBottom})},h.onTouchEnd=function(e){if(h.gestureBackActive){var t=+new Date-h.startTime;document.getElementById("root").style.overflow=null,t<300&&h._lastScreenX>.2*h.SCREEN_WIDTH?(h.animate({begin:h.BOTTOM_SCREEN_OFFSET+.3*h._lastScreenX,end:0,ref:h.preRef,duration:.05}),h.animate({begin:h._lastScreenX,end:h.SCREEN_WIDTH,ref:h.matchRef,done:h.props.adapt.history.goBack,type:"ease-out",duration:.05}),h._lastScreenX=0,h.fromGesture=!0,h.gestureBackActive=!1):(h._lastScreenX<h.SCREEN_WIDTH/2?h.reset():(h.animate({begin:h.BOTTOM_SCREEN_OFFSET+.3*h._lastScreenX,end:0,ref:h.preRef,duration:.05}),h.animate({begin:h._lastScreenX,end:h.SCREEN_WIDTH,ref:h.matchRef,done:h.props.adapt.history.goBack,type:"ease-out",duration:.05}),h.fromGesture=!0),h.gestureBackActive=!1,h._lastScreenX=0)}},h.renderGesture=function(){if(h.single)return React.createElement("div",{ref:function(e){return h.preRef=h.matchRef=e}},h.matchPage);var e=window.globalManger[window.globalManger.length-2];return h.prePage=h.findMatchElementByLocation(e),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d("+h.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,gesture_pre,{opacity:0,position:"fixed",top:-window.globalPosition[e.pathname]||0}),key:Math.random(),ref:function(e){return h.preRef=e}},h.prePage),React.createElement("div",{style:_extends({},h.SIZE,pop_match),key:Math.random(),ref:function(e){e&&(e.removeEventListener("touchstart",h.onTouchStart),e.removeEventListener("touchmove",h.onTouchMove),e.removeEventListener("touchend",h.onTouchEnd),e.addEventListener("touchstart",h.onTouchStart),e.addEventListener("touchmove",h.onTouchMove),e.addEventListener("touchend",h.onTouchEnd),e.addEventListener("touchstart",h.onTouchStart),e.addEventListener("touchmove",h.onTouchMove),e.addEventListener("touchend",h.onTouchEnd)),h.matchRef=e}},h.matchPage))},h.renderPop=function(){if(!h.prePage)return React.createElement("div",{ref:function(e){return h.matchRef=e}},h.matchPage);if(h.fromGesture)return h.renderGesture();if(h.prePage.props.path==h.matchPage.props.path){if(!(1<window.globalManger.length))return h.canAnimate=!1,React.createElement("div",{ref:function(e){return h.matchRef=e}},h.matchPage);h.props.adapt.history.goBack()}return React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d("+h.BOTTOM_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,pop_match),key:Math.random(),ref:function(e){e&&(e.removeEventListener("touchstart",h.onTouchStart),e.removeEventListener("touchmove",h.onTouchMove),e.removeEventListener("touchend",h.onTouchEnd),e.addEventListener("touchstart",h.onTouchStart),e.addEventListener("touchmove",h.onTouchMove),e.addEventListener("touchend",h.onTouchEnd)),h.matchRef=e}},h.matchPage),React.createElement("div",{style:_extends({transform:"translate3d(0px,0px,0)"},h.SIZE,pop_pre,{position:"fixed",top:window.globalPosition?-window.globalPosition[h.prePage.props.path]:0}),key:Math.random(),ref:function(e){return h.preRef=e}},h.prePage))},h.correctPosition=function(e){return window.globalPosition=window.globalPosition||{},window.globalPosition[e]=document.documentElement.scrollTop||document.body.scrollTop,document.documentElement.scrollTop=0,document.body.scrollTop=0,window.globalPosition[e]},h.renderPush=function(){if(h.single&&"REPLACE"==h.action)return h.canAnimate=!1,React.createElement("div",{ref:function(e){return h.preRef=h.matchRef=e}},h.matchPage);var e=window.globalManger[window.globalManger.length-2];return h.correctPosition(e.pathname),React.createElement(React.Fragment,null,React.createElement("div",{style:_extends({transform:"translate3d(0px,0px,0)"},h.SIZE,push_pre,{position:"fixed",top:-window.globalPosition[e.pathname]||0}),key:Math.random(),ref:function(e){return h.preRef=e}},h.prePage),React.createElement("div",{style:_extends({transform:"translate3d("+h.MATCH_SCREEN_OFFSET+"px,0px,0)"},h.SIZE,push_match),key:Math.random(),ref:function(e){e&&(e.removeEventListener("touchstart",h.onTouchStart),e.removeEventListener("touchmove",h.onTouchMove),e.removeEventListener("touchend",h.onTouchEnd),e.addEventListener("touchstart",h.onTouchStart),e.addEventListener("touchmove",h.onTouchMove),e.addEventListener("touchend",h.onTouchEnd),e.addEventListener("touchstart",h.onTouchStart),e.addEventListener("touchmove",h.onTouchMove),e.addEventListener("touchend",h.onTouchEnd)),h.matchRef=e}},h.matchPage))},h.preRender=function(){h.action=h.props.adapt.history.action,h.single=1==window.globalManger.length,document.addEventListener("WinJSBridgeReady",function(e){window.WinJSBridge.call("webview","dragbackenable",{enable:h.single})}),h.prePage=h.matchPage,h.matchPage=h.findMatchElement()},h}_inheritsLoose(e,o);var t=e.prototype;return t.componentDidUpdate=function(e,t,n){this.canAnimate&&!this.fromGesture&&("POP"==this.action?this.animatePop():this.animatePush()),this.fromGesture=!1,this.canAnimate=!0},t.render=function(){return this.preRender(),this.matchPage?"POP"==this.action?this.renderPop():this.renderPush():"404"},e}(React.Component);function withRouter(o){function e(e){var t=e.wrappedComponentRef,n=_objectWithoutPropertiesLoose(e,["wrappedComponentRef"]);return React.createElement(context.Consumer,null,function(e){return e||invariant(!1),React.createElement(o,_extends({},n,e,{ref:t}))})}var t="withRouter("+(o.displayName||o.name)+")";return e.displayName=t,e.WrappedComponent=o,hoistStatics(e,o)}function renderRoutes(e){return React.createElement(reactKeepAlive.Provider,null,React.createElement(Switch,null,e.map(function(t,n){return React.createElement(Route,_extends({key:n},t,{component:function(e){return React.createElement(reactKeepAlive.KeepAlive,{name:n.toString()},React.createElement("div",null,React.createElement(t.component,e)))}}))})))}var BrowserRouter=function(a){function e(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))||this).history=createBrowserHistory(e.props),e}return _inheritsLoose(e,a),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),HashRouter=function(a){function e(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))||this).history=createHashHistory(e.props),e}return _inheritsLoose(e,a),e.prototype.render=function(){return React.createElement(Router,{history:this.history,children:this.props.children})},e}(React.Component),resolveToLocation=function(e,t){return"function"==typeof e?e(t):e},normalizeToLocation=function(e,t){return"string"==typeof e?createLocation(e,null,null,t):e};function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function LinkAnchor(e){var t=e.innerRef,n=e.navigate,o=e.onClick,a=_objectWithoutPropertiesLoose(e,["innerRef","navigate","onClick"]),r=a.target;return React.createElement("a",_extends({},a,{ref:t,onClick:function(t){try{o&&o(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0!==t.button||r&&"_self"!==r||isModifiedEvent(t)||(t.preventDefault(),n())}}))}function Link(e){var t=e.component,a=void 0===t?LinkAnchor:t,r=e.replace,i=e.to,c=_objectWithoutPropertiesLoose(e,["component","replace","to"]);return React.createElement(context.Consumer,null,function(t){t||invariant(!1);var n=t.history,e=normalizeToLocation(resolveToLocation(i,t.location),t.location),o=e?n.createHref(e):"";return React.createElement(a,_extends({},c,{href:o,navigate:function(){var e=resolveToLocation(i,t.location);(r?n.replace:n.push)(e)}}))})}function joinClassnames(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(function(e){return e}).join(" ")}function NavLink(e){var t=e["aria-current"],h=void 0===t?"page":t,n=e.activeClassName,l=void 0===n?"active":n,p=e.activeStyle,d=e.className,f=e.exact,m=e.isActive,v=e.location,g=e.strict,E=e.style,y=e.to,P=_objectWithoutPropertiesLoose(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","strict","style","to"]);return React.createElement(context.Consumer,null,function(e){e||invariant(!1);var t=v||e.location,n=t.pathname,o=normalizeToLocation(resolveToLocation(y,t),t),a=o.pathname,r=a&&a.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),i=r?matchPath(n,{path:r,exact:f,strict:g}):null,c=!!(m?m(i,e.location):i),s=c?joinClassnames(d,l):d,u=c?_extends({},E,p):E;return React.createElement(Link,_extends({"aria-current":c&&h||null,className:s,style:u,to:o},P))})}exports.BrowserRouter=BrowserRouter,exports.HashRouter=HashRouter,exports.Link=Link,exports.NavLink=NavLink,exports.MemoryRouter=MemoryRouter,exports.Prompt=Prompt,exports.Redirect=Redirect,exports.Route=Route,exports.Router=Router,exports.StaticRouter=StaticRouter,exports.Switch=Switch,exports.generatePath=generatePath,exports.matchPath=matchPath,exports.withRouter=withRouter,exports.renderRoutes=renderRoutes,exports.__RouterContext=context,exports.createBrowserHistory=createBrowserHistory,exports.createHashHistory=createHashHistory,exports.createMemoryHistory=createMemoryHistory,exports.createLocation=createLocation,exports.locationsAreEqual=locationsAreEqual,exports.parsePath=parsePath,exports.createPath=createPath;
